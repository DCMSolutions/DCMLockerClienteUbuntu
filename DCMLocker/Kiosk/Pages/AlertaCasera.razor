@page "/alerta/{pregunta}"
@inject NavigationManager Navigation
@inject DCMLocker.Kiosk.Cliente.TLockerCliente Cliente

<br />
<br />
<h3>¿Está seguro?</h3>
<h5>Se @pregunta este locker</h5>
<br />


<div style="display: flex; gap: 10px;">
    <button type="button"
            style="flex: 1;"
            class="btn btn-primary btn-user"
            disabled="@isBusy"
            @onclick="ConfirmarAsync">
        @(isBusy ? "Procesando..." : "Confirmar")
    </button>

    <button type="button"
            style="flex: 1;"
            class="btn btn-secondary btn-user"
            disabled="@isBusy"
            @onclick="Volver">
        Cancelar
    </button>
</div>

@code {
    [Parameter] public string pregunta { get; set; }
    private bool isBusy = false;

    private async Task ConfirmarAsync()
    {
        if (isBusy) return;
        isBusy = true;
        StateHasChanged();

        try
        {
            switch (pregunta)
            {
                case "apagará":
                    await Cliente.System_Shutdown();
                    break;
                case "reseteará":
                    await Cliente.System_Reset();
                    break;
                case "actualizará":
                    await Cliente.System_Update();
                    break;
                default:
                    Navigation.NavigateTo("/");
                    break;
            }
        }
        catch (Exception)
        {
            Navigation.NavigateTo("/");
        }
    }

    private void Volver()
    {
        Navigation.NavigateTo("/");
    }
}
